<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SmokeBot Portal</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    * { 
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    :root {
      --primary: #8a2be2;
      --primary-dark: #6a1b9a;
      --primary-light: #9c4dff;
      --bg-dark: #0a0a0a;
      --bg-darker: #000000;
      --text: #c792ea;
      --text-light: #ffffff;
      --card-bg: #1a0a24;
      --success: #00e676;
      --danger: #ff1744;
      --warning: #ff9100;
      --sidebar-width: 250px;
    }
    
    body {
      font-family: 'Inter', sans-serif;
      background: var(--bg-darker);
      color: var(--text-light);
      overflow-x: hidden;
      min-height: 100vh;
      background-image: 
        radial-gradient(circle at 25% 25%, rgba(138, 43, 226, 0.1) 0%, transparent 50%),
        radial-gradient(circle at 75% 75%, rgba(138, 43, 226, 0.1) 0%, transparent 50%);
    }
    
    .login-container, .dashboard, .admin-panel, .tos-section, .shop-section {
      display: none;
      padding: 2rem;
      margin-left: var(--sidebar-width);
      transition: all 0.3s ease;
    }
    
    .active { 
      display: block !important; 
      animation: fadeIn 0.5s ease;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .sidebar {
      position: fixed;
      top: 0;
      left: 0;
      height: 100%;
      width: var(--sidebar-width);
      background: rgba(15, 5, 25, 0.95);
      padding-top: 2rem;
      display: flex;
      flex-direction: column;
      z-index: 1000;
      box-shadow: 4px 0 15px rgba(0, 0, 0, 0.3);
      backdrop-filter: blur(10px);
      border-right: 1px solid rgba(138, 43, 226, 0.2);
      transform: translateX(-100%);
      transition: transform 0.3s ease;
    }
    
    .sidebar.active {
      transform: translateX(0);
    }
    
    .sidebar-header {
      padding: 0 1.5rem 1.5rem;
      border-bottom: 1px solid rgba(138, 43, 226, 0.2);
      margin-bottom: 1rem;
    }
    
    .sidebar-header h3 {
      color: var(--primary);
      font-size: 1.2rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .sidebar-header p {
      font-size: 0.8rem;
      color: var(--text);
      opacity: 0.8;
    }
    
    .sidebar a {
      color: var(--text-light);
      padding: 0.8rem 1.5rem;
      text-decoration: none;
      margin: 0.25rem 1rem;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      gap: 0.8rem;
      border-radius: 6px;
      font-size: 0.95rem;
      position: relative;
      overflow: hidden;
    }
    
    .sidebar a::before {
      content: "";
      position: absolute;
      left: 0;
      top: 0;
      height: 100%;
      width: 3px;
      background: var(--primary);
      transform: translateX(-10px);
      opacity: 0;
      transition: all 0.3s ease;
    }
    
    .sidebar a:hover {
      background: rgba(138, 43, 226, 0.1);
      transform: translateX(5px);
    }
    
    .sidebar a:hover::before {
      transform: translateX(0);
      opacity: 1;
    }
    
    .sidebar a i {
      width: 20px;
      text-align: center;
    }
    
    .sidebar-toggle {
      position: fixed;
      top: 20px;
      left: 20px;
      background: var(--primary);
      color: white;
      border: none;
      padding: 0.6rem;
      border-radius: 8px;
      cursor: pointer;
      z-index: 1100;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 10px rgba(138, 43, 226, 0.3);
      transition: all 0.3s ease;
    }
    
    .sidebar-toggle:hover {
      transform: scale(1.1);
      box-shadow: 0 6px 15px rgba(138, 43, 226, 0.4);
    }
    
    /* Hide sidebar toggle on login page */
    .login-container.active ~ .sidebar-toggle {
      display: none;
    }
    
    .login-container:not(.active) ~ .sidebar-toggle {
      display: flex;
    }
    
    .section {
      margin-bottom: 2rem;
      padding: 1.5rem;
      background: rgba(25, 10, 35, 0.7);
      border-radius: 12px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      border: 1px solid rgba(138, 43, 226, 0.1);
      transition: all 0.3s ease;
    }
    
    .section:hover {
      border-color: rgba(138, 43, 226, 0.3);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
    }
    
    h1, h2, h3, h4 {
      color: var(--text-light);
      font-weight: 600;
      margin-bottom: 1rem;
    }
    
    h2 {
      font-size: 1.8rem;
      background: linear-gradient(90deg, var(--primary), var(--text));
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      display: inline-block;
      position: relative;
      padding-bottom: 0.5rem;
    }
    
    h2::after {
      content: "";
      position: absolute;
      bottom: 0;
      left: 0;
      width: 50%;
      height: 3px;
      background: linear-gradient(90deg, var(--primary), transparent);
      border-radius: 3px;
    }
    
    h3 {
      font-size: 1.3rem;
      color: var(--primary-light);
      margin-bottom: 1rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    h3 i {
      font-size: 1.1rem;
    }
    
    p {
      line-height: 1.6;
      margin-bottom: 0.5rem;
      color: rgba(255, 255, 255, 0.8);
    }
    
    strong {
      color: var(--text-light);
      font-weight: 600;
    }
    
    button {
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      color: white;
      border: none;
      padding: 0.8rem 1.5rem;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 500;
      transition: all 0.2s ease;
      box-shadow: 0 4px 10px rgba(138, 43, 226, 0.3);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
    }
    
    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 15px rgba(138, 43, 226, 0.4);
      background: linear-gradient(135deg, var(--primary-light), var(--primary));
    }
    
    button:active {
      transform: translateY(0);
    }
    
    button.secondary {
      background: transparent;
      border: 1px solid var(--primary);
      color: var(--primary-light);
      box-shadow: none;
    }
    
    button.secondary:hover {
      background: rgba(138, 43, 226, 0.1);
    }
    
    button.danger {
      background: linear-gradient(135deg, var(--danger), #c51162);
    }
    
    button.danger:hover {
      background: linear-gradient(135deg, #ff4569, var(--danger));
    }
    
    button.warning {
      background: linear-gradient(135deg, var(--warning), #ff6d00);
    }
    
    button.warning:hover {
      background: linear-gradient(135deg, #ffa040, var(--warning));
    }
    
    button.success {
      background: linear-gradient(135deg, var(--success), #00c853);
    }
    
    button.success:hover {
      background: linear-gradient(135deg, #00e676, var(--success));
    }
    
    input, select, textarea {
      padding: 0.8rem;
      margin: 0.5rem 0;
      border-radius: 8px;
      border: 1px solid rgba(138, 43, 226, 0.3);
      background: rgba(30, 15, 40, 0.7);
      color: var(--text-light);
      width: 100%;
      max-width: 400px;
      transition: all 0.2s ease;
      font-family: 'Inter', sans-serif;
    }
    
    input:focus, select:focus, textarea:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(138, 43, 226, 0.2);
    }
    
    input::placeholder {
      color: rgba(255, 255, 255, 0.4);
    }
    
    .form-group {
      margin-bottom: 1rem;
    }
    
    .form-group label {
      display: block;
      margin-bottom: 0.3rem;
      color: var(--text);
      font-size: 0.9rem;
    }
    
    .user-info-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 1rem;
      margin-bottom: 1.5rem;
    }
    
    .user-info-item {
      background: rgba(138, 43, 226, 0.05);
      padding: 1rem;
      border-radius: 8px;
      border-left: 3px solid var(--primary);
    }
    
    .user-info-item strong {
      display: block;
      font-size: 0.8rem;
      color: var(--text);
      margin-bottom: 0.3rem;
    }
    
    .user-info-item span {
      font-size: 1.1rem;
      color: var(--text-light);
    }
    
    .shop-items {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 1.5rem;
    }
    
    .shop-item {
      background: rgba(30, 15, 40, 0.7);
      border-radius: 10px;
      padding: 1.5rem;
      text-align: center;
      border: 1px solid rgba(138, 43, 226, 0.2);
      transition: all 0.3s ease;
    }
    
    .shop-item:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
      border-color: var(--primary);
    }
    
    .shop-item h4 {
      font-size: 1.3rem;
      color: var(--primary-light);
      margin-bottom: 0.5rem;
    }
    
    .shop-item .price {
      font-size: 1.8rem;
      font-weight: 700;
      color: var(--text-light);
      margin: 1rem 0;
    }
    
    .shop-item .duration {
      color: var(--text);
      margin-bottom: 1.5rem;
    }
    
    .account-list {
      list-style: none;
    }
    
    .account-item {
      background: rgba(30, 15, 40, 0.7);
      padding: 1rem;
      border-radius: 8px;
      margin-bottom: 0.8rem;
      border-left: 3px solid var(--primary);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .account-item.blacklisted {
      border-left-color: var(--danger);
      opacity: 0.7;
    }
    
    .account-item .account-info {
      flex: 1;
    }
    
    .account-item .account-actions {
      display: flex;
      gap: 0.5rem;
    }
    
    .account-item .account-actions button {
      padding: 0.5rem;
      font-size: 0.8rem;
    }
    
    .status-badge {
      display: inline-block;
      padding: 0.2rem 0.5rem;
      border-radius: 20px;
      font-size: 0.7rem;
      font-weight: 600;
      margin-left: 0.5rem;
    }
    
    .status-active {
      background: rgba(0, 230, 118, 0.2);
      color: var(--success);
    }
    
    .status-blacklisted {
      background: rgba(239, 35, 60, 0.2);
      color: var(--danger);
    }
    
    #logout-btn {
      margin-top: auto;
      margin: 1rem;
      background: rgba(138, 43, 226, 0.2);
      border: 1px solid var(--primary);
    }
    
    #logout-btn:hover {
      background: rgba(138, 43, 226, 0.3);
    }
    
    .login-box {
      max-width: 450px;
      margin: 2rem auto;
      background: rgba(20, 10, 30, 0.8);
      border-radius: 15px;
      padding: 2.5rem;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      border: 1px solid rgba(138, 43, 226, 0.2);
      text-align: center;
      position: relative;
      overflow: hidden;
    }
    
    .login-box::before {
      content: "";
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(138, 43, 226, 0.1) 0%, transparent 70%);
      animation: rotate 20s linear infinite;
      z-index: -1;
    }
    
    @keyframes rotate {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    
    .login-logo {
      margin-bottom: 1.5rem;
    }
    
    .login-logo i {
      font-size: 3rem;
      color: var(--primary);
      margin-bottom: 1rem;
    }
    
    .login-logo h2 {
      font-size: 2rem;
      margin-bottom: 0.5rem;
    }
    
    .login-logo p {
      color: var(--text);
      font-size: 0.9rem;
    }
    
    .login-form {
      margin: 2rem 0;
    }
    
    .login-footer {
      margin-top: 1.5rem;
      font-size: 0.8rem;
      color: rgba(255, 255, 255, 0.5);
    }
    
    .notification {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 1rem 1.5rem;
      border-radius: 8px;
      background: var(--primary);
      color: white;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      z-index: 2000;
      display: flex;
      align-items: center;
      gap: 0.8rem;
      transform: translateX(150%);
      transition: transform 0.3s ease;
    }
    
    .notification.show {
      transform: translateX(0);
    }
    
    .notification i {
      font-size: 1.2rem;
    }
    
    .notification.success {
      background: var(--success);
    }
    
    .notification.error {
      background: var(--danger);
    }
    
    .notification.warning {
      background: var(--warning);
    }
    
    .gift-code-section {
      background: rgba(138, 43, 226, 0.05);
      border: 1px dashed rgba(138, 43, 226, 0.3);
      padding: 1.5rem;
      border-radius: 8px;
      margin-top: 1.5rem;
    }
    
    .gift-code-input {
      display: flex;
      gap: 0.5rem;
      margin-top: 1rem;
    }
    
    .gift-code-input input {
      flex: 1;
    }
    
    .gift-code-list {
      margin-top: 1rem;
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
    }
    
    .gift-code-item {
      background: rgba(138, 43, 226, 0.1);
      padding: 0.5rem 1rem;
      border-radius: 20px;
      font-size: 0.9rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .gift-code-item i {
      cursor: pointer;
      opacity: 0.7;
      transition: all 0.2s ease;
    }
    
    .gift-code-item i:hover {
      opacity: 1;
      color: var(--danger);
    }
    
    .app-settings {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1.5rem;
      margin-top: 1.5rem;
    }
    
    @media (max-width: 768px) {
      .login-container, .dashboard, .admin-panel, .tos-section, .shop-section {
        margin-left: 0;
        padding: 1.5rem;
      }
      
      .sidebar {
        width: 80%;
        transform: translateX(-100%);
      }
      
      .sidebar.active {
        transform: translateX(0);
      }
      
      .user-info-grid {
        grid-template-columns: 1fr;
      }
      
      .shop-items {
        grid-template-columns: 1fr;
      }
      
      .app-settings {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <button class="sidebar-toggle" onclick="toggleSidebar()">
    <i class="fas fa-bars"></i>
  </button>
  
  <div class="notification" id="notification">
    <i class="fas fa-check-circle"></i>
    <span id="notification-message">Success!</span>
  </div>
  
  <div class="login-container active" id="login">
    <div class="login-box">
      <div class="login-logo">
        <i class="fas fa-robot"></i>
        <h2>SMOKEBOT PORTAL</h2>
        <p>Secure access to your SmokeBot services</p>
      </div>
      
      <div class="login-form">
        <div class="form-group">
          <input type="text" id="login-username" placeholder="Username" />
        </div>
        <div class="form-group">
          <input type="text" id="login-discord" placeholder="Discord ID" />
        </div>
        <button onclick="login()" style="width: 100%; padding: 1rem;">
          <i class="fas fa-sign-in-alt"></i> Login
        </button>
      </div>
      
      <div class="login-footer">
        <p>Having trouble? Contact support on Discord</p>
      </div>
    </div>
  </div>
  
  <div class="sidebar" id="sidebar">
    <div class="sidebar-header">
      <h3><i class="fas fa-robot"></i> SmokeBot</h3>
      <p>Premium Cheat Portal</p>
    </div>
    
    <a href="#" onclick="showSection('dashboard')">
      <i class="fas fa-tachometer-alt"></i> Dashboard
    </a>
    <a href="#" onclick="showSection('shop')">
      <i class="fas fa-shopping-cart"></i> Shop
    </a>
    <a href="#" id="admin-link" onclick="showSection('admin')" style="display:none;">
      <i class="fas fa-user-shield"></i> Admin Panel
    </a>
    <a href="#" onclick="showSection('tos')">
      <i class="fas fa-file-contract"></i> Terms
    </a>
    <a href="#" onclick="logout()" id="logout-btn">
      <i class="fas fa-sign-out-alt"></i> Logout
    </a>
  </div>
  
  <div class="dashboard" id="dashboard">
    <h2>Welcome, <span id="user-name"></span></h2>
    
    <div class="user-info-grid">
      <div class="user-info-item">
        <strong>Discord ID</strong>
        <span id="user-discord"></span>
      </div>
      <div class="user-info-item">
        <strong>License Key</strong>
        <span id="user-key"></span>
      </div>
      <div class="user-info-item">
        <strong>License Duration</strong>
        <span id="user-duration"></span>
      </div>
      <div class="user-info-item">
        <strong>Active Since</strong>
        <span id="days-active"></span> days
      </div>
    </div>
    
    <div class="section">
      <h3><i class="fas fa-download"></i> Download</h3>
      <p>Download the latest version of SmokeBot</p>
      <button id="download-btn">
        <i class="fas fa-download"></i> Download SmokeBot
      </button>
    </div>
    
    <div class="section">
      <h3><i class="fas fa-gift"></i> Redeem Gift Code</h3>
      <p>Enter a gift code to extend your license</p>
      <div class="gift-code-section">
        <div class="gift-code-input">
          <input type="text" id="gift-code-input" placeholder="Enter gift code">
          <button onclick="redeemGiftCode()">
            <i class="fas fa-check"></i> Redeem
          </button>
        </div>
        <div class="gift-code-list" id="gift-code-list"></div>
      </div>
    </div>
    
    <div class="section">
      <h3><i class="fas fa-headset"></i> Support</h3>
      <p>Need help? Join our Discord server for support</p>
      <button onclick="window.open('https://discord.gg/gbQCY8crgU', '_blank')">
        <i class="fab fa-discord"></i> Join Discord
      </button>
    </div>
    
    <div class="section">
      <h3><i class="fas fa-sync-alt"></i> Updates</h3>
      <p>Current version: <strong id="current-version">v2.1.4</strong></p>
      <p>Status: <span class="status-badge" id="version-status">Up to date</span></p>
    </div>
  </div>
  
  <div class="shop-section" id="shop">
    <h2>Shop</h2>
    <p>Purchase or extend your SmokeBot license</p>
    
    <div class="shop-items">
      <div class="shop-item">
        <h4>1 Week</h4>
        <div class="price">$5</div>
        <div class="duration">7 days access</div>
        <button class="secondary">
          <i class="fas fa-cart-plus"></i> Purchase
        </button>
      </div>
      
      <div class="shop-item">
        <h4>1 Month</h4>
        <div class="price">$10</div>
        <div class="duration">30 days access</div>
        <button class="secondary">
          <i class="fas fa-cart-plus"></i> Purchase
        </button>
      </div>
      
      <div class="shop-item">
        <h4>Lifetime</h4>
        <div class="price">$25</div>
        <div class="duration">Permanent access</div>
        <button>
          <i class="fas fa-crown"></i> Purchase
        </button>
      </div>
    </div>
  </div>
  
  <div class="admin-panel" id="admin">
    <h2>Admin Panel</h2>
    
    <div class="section">
      <h3><i class="fas fa-user-plus"></i> Create Account</h3>
      <div class="form-group">
        <label>Username</label>
        <input id="new-username" placeholder="Username">
      </div>
      <div class="form-group">
        <label>Discord ID</label>
        <input id="new-discord" placeholder="Discord ID">
      </div>
      <div class="form-group">
        <label>HWID</label>
        <input id="new-hwid" placeholder="HWID">
      </div>
      <div class="form-group">
        <label>Duration</label>
        <select id="new-duration">
          <option value="1 Week">1 Week</option>
          <option value="1 Month">1 Month</option>
          <option value="Lifetime">Lifetime</option>
        </select>
      </div>
      <button onclick="createAccount()">
        <i class="fas fa-save"></i> Create Account
      </button>
    </div>
    
    <div class="section">
      <h3><i class="fas fa-gift"></i> Gift Licenses</h3>
      <p>Generate gift codes for licenses</p>
      <div style="display: flex; gap: 1rem; margin-top: 1rem;">
        <button class="secondary" onclick="generateGiftCode('1 Week')">
          <i class="fas fa-gift"></i> 1 Week
        </button>
        <button class="secondary" onclick="generateGiftCode('1 Month')">
          <i class="fas fa-gift"></i> 1 Month
        </button>
        <button onclick="generateGiftCode('Lifetime')">
          <i class="fas fa-gift"></i> Lifetime
        </button>
      </div>
      <div class="gift-code-section">
        <h4>Generated Gift Codes</h4>
        <div class="gift-code-list" id="admin-gift-code-list"></div>
      </div>
    </div>
    
    <div class="section">
      <h3><i class="fas fa-cog"></i> Application Settings</h3>
      <div class="app-settings">
        <div>
          <div class="form-group">
            <label>Download Link</label>
            <input type="text" id="download-link" placeholder="https://example.com/download">
          </div>
          <button onclick="saveDownloadLink()">
            <i class="fas fa-save"></i> Save Download Link
          </button>
        </div>
        <div>
          <div class="form-group">
            <label>Current Version</label>
            <input type="text" id="app-version" placeholder="v2.1.4">
          </div>
          <div class="form-group">
            <label>Version Status</label>
            <select id="version-status-select">
              <option value="Up to date">Up to date</option>
              <option value="Update available">Update available</option>
              <option value="Maintenance">Maintenance</option>
            </select>
          </div>
          <button onclick="saveVersionSettings()">
            <i class="fas fa-save"></i> Save Version Settings
          </button>
        </div>
      </div>
    </div>
    
    <div class="section">
      <h3><i class="fas fa-users"></i> Existing Accounts</h3>
      <p>Manage all registered accounts</p>
      <ul class="account-list" id="account-list"></ul>
    </div>
  </div>
  
  <div class="tos-section" id="tos">
    <h2>Terms of Use</h2>
    
    <div class="section">
      <h3><i class="fas fa-shield-alt"></i> Important Information</h3>
      <p><strong>1. Access:</strong> Only valid licenses can log in. Sharing accounts is prohibited.</p>
      <p><strong>2. Security:</strong> Abuse will lead to permanent ban without refund.</p>
      <p><strong>3. Support:</strong> Join our Discord for any questions or issues.</p>
      <p><strong>4. Refunds:</strong> No refunds will be issued for any reason.</p>
      <p><strong>5. Updates:</strong> We reserve the right to update these terms at any time.</p>
    </div>
    
    <div class="section">
      <h3><i class="fas fa-exclamation-triangle"></i> Warning</h3>
      <p>Using cheats in online games may result in account bans. We are not responsible for any consequences of using our software.</p>
      <p>Use at your own risk.</p>
    </div>
  </div>

  <script>
    // Application data with new key format
    let accounts = [
      {
        username: "client",
        discord: "client#1234",
        key: "Smoke-1w-AB12-CD34",
        hwid: "A1B2-C3D4-E5F6",
        duration: "1 Week",
        startDate: new Date("2025-07-24"),
        blacklisted: false
      },
      {
        username: "admin",
        discord: "admin#0001",
        key: "Smoke-lft-ADMN-0001",
        hwid: "ADMIN-HWID-001",
        duration: "Lifetime",
        startDate: new Date("2025-07-20"),
        blacklisted: false
      }
    ];
    
    let currentUser = null;
    let giftCodes = [];
    let appSettings = {
      downloadLink: "https://example.com/download",
      currentVersion: "v2.1.4",
      versionStatus: "Up to date"
    };
    
    // Generate a license key with the new format
    function generateLicenseKey(duration) {
      const prefix = duration === "Lifetime" ? "lft" : 
                    duration === "1 Month" ? "1m" : "1w";
      const randomPart = Math.random().toString(36).substring(2, 6).toUpperCase() + '-' +
                        Math.random().toString(36).substring(2, 6).toUpperCase();
      return `Smoke-${prefix}-${randomPart}`;
    }

    // Load settings from localStorage if available
    function loadSettings() {
      const savedSettings = localStorage.getItem('smokebotSettings');
      if (savedSettings) {
        appSettings = JSON.parse(savedSettings);
      }
      
      const savedAccounts = localStorage.getItem('smokebotAccounts');
      if (savedAccounts) {
        accounts = JSON.parse(savedAccounts);
      }
      
      const savedGiftCodes = localStorage.getItem('smokebotGiftCodes');
      if (savedGiftCodes) {
        giftCodes = JSON.parse(savedGiftCodes);
      }
      
      updateSettingsUI();
      updateGiftCodeLists();
    }
    
    // Save settings to localStorage
    function saveSettings() {
      localStorage.setItem('smokebotSettings', JSON.stringify(appSettings));
      localStorage.setItem('smokebotAccounts', JSON.stringify(accounts));
      localStorage.setItem('smokebotGiftCodes', JSON.stringify(giftCodes));
    }
    
    // Update UI with current settings
    function updateSettingsUI() {
      document.getElementById('download-link').value = appSettings.downloadLink;
      document.getElementById('app-version').value = appSettings.currentVersion;
      document.getElementById('version-status-select').value = appSettings.versionStatus;
      
      document.getElementById('current-version').textContent = appSettings.currentVersion;
      document.getElementById('version-status').textContent = appSettings.versionStatus;
      document.getElementById('version-status').className = `status-badge status-${appSettings.versionStatus.toLowerCase().replace(' ', '-')}`;
      
      // Update download button
      const downloadBtn = document.getElementById('download-btn');
      if (downloadBtn) {
        downloadBtn.onclick = function() {
          window.open(appSettings.downloadLink, '_blank');
        };
      }
    }
    
    // Update gift code lists in UI
    function updateGiftCodeLists() {
      const adminList = document.getElementById('admin-gift-code-list');
      const userList = document.getElementById('gift-code-list');
      
      if (adminList) {
        adminList.innerHTML = '';
        giftCodes.forEach((code, index) => {
          const codeEl = document.createElement('div');
          codeEl.className = 'gift-code-item';
          codeEl.innerHTML = `
            ${code.code} (${code.duration})
            <i class="fas fa-copy" onclick="copyToClipboard('${code.code}')"></i>
            <i class="fas fa-trash" onclick="deleteGiftCode(${index})"></i>
          `;
          adminList.appendChild(codeEl);
        });
      }
      
      if (userList && currentUser) {
        userList.innerHTML = '';
        currentUser.redeemedCodes?.forEach(code => {
          const codeEl = document.createElement('div');
          codeEl.className = 'gift-code-item';
          codeEl.textContent = `${code.code} (${code.duration}) - Redeemed`;
          userList.appendChild(codeEl);
        });
      }
    }
    
    // Generate a new gift code with the new format
    function generateGiftCode(duration) {
      const prefix = duration === "Lifetime" ? "lft" : 
                    duration === "1 Month" ? "1m" : "1w";
      const randomPart = Math.random().toString(36).substring(2, 6).toUpperCase() + '-' +
                        Math.random().toString(36).substring(2, 6).toUpperCase();
      const code = `Smoke-${prefix}-${randomPart}`;
      
      giftCodes.push({
        code,
        duration,
        createdAt: new Date()
      });
      
      saveSettings();
      updateGiftCodeLists();
      showNotification(`Generated ${duration} gift code: ${code}`);
    }
    
    // Delete a gift code
    function deleteGiftCode(index) {
      giftCodes.splice(index, 1);
      saveSettings();
      updateGiftCodeLists();
      showNotification("Gift code deleted", "error");
    }
    
    // Redeem a gift code
    function redeemGiftCode() {
      const codeInput = document.getElementById('gift-code-input');
      const code = codeInput.value.trim();
      
      if (!code) {
        showNotification("Please enter a gift code", "error");
        return;
      }
      
      const giftCode = giftCodes.find(gc => gc.code === code);
      
      if (!giftCode) {
        showNotification("Invalid gift code", "error");
        return;
      }
      
      // Remove from available codes
      const codeIndex = giftCodes.findIndex(gc => gc.code === code);
      giftCodes.splice(codeIndex, 1);
      
      // Add to user's redeemed codes
      if (!currentUser.redeemedCodes) {
        currentUser.redeemedCodes = [];
      }
      currentUser.redeemedCodes.push(giftCode);
      
      // Extend license duration
      if (currentUser.duration !== "Lifetime") {
        if (giftCode.duration === "Lifetime") {
          currentUser.duration = "Lifetime";
        } else if (giftCode.duration === "1 Month" && currentUser.duration === "1 Week") {
          currentUser.duration = "1 Month";
        } else if (giftCode.duration === "1 Month") {
          // Add 30 days to current duration
          const newDate = new Date(currentUser.startDate);
          newDate.setDate(newDate.getDate() + 30);
          currentUser.startDate = newDate;
        } else if (giftCode.duration === "1 Week") {
          // Add 7 days to current duration
          const newDate = new Date(currentUser.startDate);
          newDate.setDate(newDate.getDate() + 7);
          currentUser.startDate = newDate;
        }
      }
      
      saveSettings();
      updateUserInfo();
      updateGiftCodeLists();
      codeInput.value = '';
      showNotification(`Redeemed ${giftCode.duration} gift code successfully!`);
    }
    
    // Save download link
    function saveDownloadLink() {
      const link = document.getElementById('download-link').value.trim();
      if (!link) {
        showNotification("Please enter a download link", "error");
        return;
      }
      
      appSettings.downloadLink = link;
      saveSettings();
      updateSettingsUI();
      showNotification("Download link saved!");
    }
    
    // Save version settings
    function saveVersionSettings() {
      const version = document.getElementById('app-version').value.trim();
      const status = document.getElementById('version-status-select').value;
      
      if (!version) {
        showNotification("Please enter a version number", "error");
        return;
      }
      
      appSettings.currentVersion = version;
      appSettings.versionStatus = status;
      saveSettings();
      updateSettingsUI();
      showNotification("Version settings saved!");
    }
    
    // Copy text to clipboard
    function copyToClipboard(text) {
      navigator.clipboard.writeText(text);
      showNotification("Copied to clipboard!");
    }
    
    // Show notification
    function showNotification(message, type = "success") {
      const notification = document.getElementById("notification");
      const messageEl = document.getElementById("notification-message");
      
      // Set icon based on type
      let icon = "fa-check-circle";
      if (type === "error") icon = "fa-times-circle";
      if (type === "warning") icon = "fa-exclamation-circle";
      
      notification.innerHTML = `<i class="fas ${icon}"></i> <span id="notification-message">${message}</span>`;
      notification.className = `notification show ${type}`;
      
      // Hide after 3 seconds
      setTimeout(() => {
        notification.classList.remove("show");
      }, 3000);
    }
    
    function login() {
      const user = document.getElementById("login-username").value;
      const discord = document.getElementById("login-discord").value;
      
      if (!user || !discord) {
        showNotification("Please fill in all fields", "error");
        return;
      }
      
      const acc = accounts.find(a => a.username === user && a.discord === discord && !a.blacklisted);
      
      if (acc) {
        currentUser = acc;
        document.getElementById("login").classList.remove("active");
        // Only show sidebar after successful login
        document.getElementById("sidebar").classList.add("active");
        
        if (acc.username === "admin") {
          document.getElementById("admin-link").style.display = "flex";
        }
        
        showSection("dashboard");
        updateUserInfo();
        refreshAccountList();
        loadSettings();
        showNotification("Login successful!");
      } else {
        showNotification("Login failed or user is blacklisted", "error");
      }
    }
    
    function updateUserInfo() {
      if (!currentUser) return;
      
      document.getElementById("user-name").textContent = currentUser.username;
      document.getElementById("user-discord").textContent = currentUser.discord;
      document.getElementById("user-key").textContent = currentUser.key;
      document.getElementById("user-duration").textContent = currentUser.duration;
      
      const today = new Date();
      const days = Math.floor((today - new Date(currentUser.startDate)) / (1000 * 60 * 60 * 24));
      document.getElementById("days-active").textContent = Math.floor(days);
    }
    
    function logout() {
      currentUser = null;
      // Hide sidebar when logging out
      document.getElementById("sidebar").classList.remove("active");
      document.querySelectorAll('.dashboard, .admin-panel, .tos-section, .shop-section').forEach(s => s.classList.remove('active'));
      document.getElementById("login").classList.add("active");
      document.getElementById("admin-link").style.display = "none";
      showNotification("Logged out successfully");
    }
    
    function showSection(sectionId) {
      document.querySelectorAll('.dashboard, .admin-panel, .tos-section, .shop-section').forEach(s => s.classList.remove('active'));
      document.getElementById(sectionId).classList.add("active");
      
      // Close sidebar on mobile
      if (window.innerWidth <= 768) {
        document.getElementById("sidebar").classList.remove("active");
      }
    }
    
    function createAccount() {
      const u = document.getElementById("new-username").value;
      const d = document.getElementById("new-discord").value;
      const h = document.getElementById("new-hwid").value;
      const dur = document.getElementById("new-duration").value;
      
      if (!u || !d || !h) {
        showNotification("Please fill in all fields", "error");
        return;
      }
      
      // Check if username already exists
      if (accounts.some(a => a.username === u)) {
        showNotification("Username already exists", "error");
        return;
      }
      
      // Generate key with new format
      const k = generateLicenseKey(dur);
      
      accounts.push({ 
        username: u, 
        discord: d, 
        key: k, 
        hwid: h, 
        duration: dur, 
        startDate: new Date(), 
        blacklisted: false 
      });
      
      // Clear form
      document.getElementById("new-username").value = "";
      document.getElementById("new-discord").value = "";
      document.getElementById("new-hwid").value = "";
      
      saveSettings();
      refreshAccountList();
      showNotification(`Account created with key: ${k}`);
    }
    
    function refreshAccountList() {
      const list = document.getElementById("account-list");
      list.innerHTML = "";
      
      accounts.forEach((acc, index) => {
        const item = document.createElement("li");
        item.className = `account-item ${acc.blacklisted ? "blacklisted" : ""}`;
        
        item.innerHTML = `
          <div class="account-info">
            <strong>${acc.username}</strong> (${acc.discord})
            <div style="font-size: 0.8rem; color: var(--text); margin-top: 0.3rem;">
              Key: ${acc.key} | ${acc.duration}
              ${acc.blacklisted ? '<span class="status-badge status-blacklisted">Blacklisted</span>' : 
                                 '<span class="status-badge status-active">Active</span>'}
            </div>
          </div>
          <div class="account-actions">
            ${acc.blacklisted ? 
              `<button class="success" onclick="unblacklistUser(${index})" title="Unblacklist">
                <i class="fas fa-check"></i>
              </button>` : 
              `<button class="warning" onclick="blacklistUser(${index})" title="Blacklist">
                <i class="fas fa-ban"></i>
              </button>`}
            <button class="danger" onclick="deleteUser(${index})" title="Delete">
              <i class="fas fa-trash"></i>
            </button>
          </div>
        `;
        
        list.appendChild(item);
      });
    }
    
    function blacklistUser(index) {
      accounts[index].blacklisted = true;
      saveSettings();
      refreshAccountList();
      showNotification("User blacklisted", "warning");
    }
    
    function unblacklistUser(index) {
      accounts[index].blacklisted = false;
      saveSettings();
      refreshAccountList();
      showNotification("User unblacklisted");
    }
    
    function deleteUser(index) {
      if (confirm("Are you sure you want to delete this account?")) {
        accounts.splice(index, 1);
        saveSettings();
        refreshAccountList();
        showNotification("Account deleted", "error");
      }
    }
    
    function toggleSidebar() {
      document.getElementById("sidebar").classList.toggle("active");
    }
    
    // Close sidebar when clicking outside
    document.addEventListener('click', function(event) {
      const sidebar = document.getElementById('sidebar');
      const toggleBtn = document.querySelector('.sidebar-toggle');
      
      if (sidebar.classList.contains('active') && 
          !sidebar.contains(event.target) && 
          event.target !== toggleBtn && 
          !toggleBtn.contains(event.target)) {
        sidebar.classList.remove('active');
      }
    });
    
    // Initialize
    document.addEventListener('DOMContentLoaded', function() {
      loadSettings();
    });
  </script>
</body>
</html>
